# Phase 2.3: Analyze Tool Refactoring - Separation Plan

**Date**: 2025-09-30  
**Target File**: `tools/workflows/analyze.py`  
**Current Size**: 795 lines  
**Target Size**: ~615 lines  
**Expected Reduction**: 23% (180 lines)

---

## EXAI Analysis Summary

**Tool Used**: `analyze_EXAI-WS` (3-step systematic analysis)  
**Confidence**: Medium (validated architectural assessment)

### Key Findings

**Architecture**: ✅ Well-designed workflow tool
**Scalability**: ✅ GOOD (configurable analysis types, git-aware)
**Maintainability**: ⚠️ MODERATE (file size exceeds AI context limits)
**Security**: ✅ GOOD (proper validation, safe git commands)
**Complexity**: ✅ APPROPRIATE (not overengineered)

**Extraction Opportunities**:
1. ANALYZE_WORKFLOW_FIELD_DESCRIPTIONS dictionary (64 lines)
2. AnalyzeWorkflowRequest class with validators (103 lines)

---

## Refactoring Strategy

### Module Breakdown

#### 1. analyze_config.py (~70 lines) - NEW
**Purpose**: Field descriptions and configuration

**Contents**:
- ANALYZE_WORKFLOW_FIELD_DESCRIPTIONS dictionary

**Exports**:
- `ANALYZE_WORKFLOW_FIELD_DESCRIPTIONS`

---

#### 2. analyze_models.py (~115 lines) - NEW
**Purpose**: Request model with validators

**Contents**:
- AnalyzeWorkflowRequest class
- Pydantic validators (validate_step_one_requirements, normalize_analysis_type)

**Exports**:
- `AnalyzeWorkflowRequest`

---

#### 3. analyze.py (~615 lines) - REFACTORED
**Purpose**: Core workflow tool class

**Changes**:
- ✅ Import from analyze_config and analyze_models
- ✅ Remove ANALYZE_WORKFLOW_FIELD_DESCRIPTIONS
- ✅ Remove AnalyzeWorkflowRequest class
- ✅ Update get_input_schema() to use imported dictionary

---

## Implementation Steps

1. Create analyze_config.py with field descriptions
2. Create analyze_models.py with request model
3. Create backup of analyze.py
4. Update imports in analyze.py
5. Remove extracted components
6. Test and validate

---

**Expected Reduction**: 795 → ~615 lines (23% reduction)

